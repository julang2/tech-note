
# 非阻塞I/O

在打开文件时指定`O_NONBLCOK`（非阻塞）标志，目的有二：

- 若`open()`调用未能立即打开文件，则返回错误，而非陷入阻塞。有一种情况属于例外，调用`open()`操作`FIFO`肯能会陷入阻塞。
- 调用`open()`成功后，后续的`I/O`操作也是非阻塞的。若`I/O`系统调用（占用cpu时间？）未能立即完成，则可能会只传输部分数据，或者系统调用失败，并返回`EAGAIN`或`EWOULDBLOCK`错误。具体返回何种错误依赖于系统调用。Linux系统与许多Unix系统实现一样，将两个错误常量视为同义。


管道、FIFO、套接字、设备（比如终端、伪终端）都支持非阻塞模式。

由于内核缓冲区保证了普通文件`I/O`不会陷入阻塞，故而打开普通文件时一般会忽略`O_NONBLOCK`标志。然而，当使用强制文件锁时，`O_NONBLOCK`标志对普通文件也是起作用的。